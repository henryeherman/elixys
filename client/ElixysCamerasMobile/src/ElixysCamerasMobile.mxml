<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" xmlns:mx="library://ns.adobe.com/flex/mx"
			   creationComplete="OnCreationComplete()">
	<fx:Script>
		<![CDATA[
			import mx.core.UIComponent;
			
			// Called when creation is complete
			private function OnCreationComplete():void
			{
				// Play reactor video streams
				var sURL:String = "http://192.168.16.129:8081/";
				PlayVideoStream(_reactor1, sURL + "reactor1.flv");
				PlayVideoStream(_reactor2, sURL + "reactor2.flv");
				PlayVideoStream(_reactor3, sURL + "reactor3.flv");
			}
			
			// Plays the specified video stream
			private function PlayVideoStream(pUIComponent:UIComponent, pURL:String):void
			{
				// Create the video and net connection
				var pReactorVideo:Video = new Video();
				pUIComponent.addChild(pReactorVideo);
				var pReactorNetConnection:NetConnection = new NetConnection();
				pReactorNetConnection.connect(null);
				
				// Create the net stream and play the stream
				var pReactorNetStream:NetStream = new NetStream(pReactorNetConnection);
				pReactorNetStream.client = {};
				pReactorNetStream.client.onMetaData = OnMetaData;
				pReactorNetStream.play(pURL);
				pReactorVideo.attachNetStream(pReactorNetStream);
				
				// Metadata handler
				function OnMetaData(item:Object):void
				{
					// Resize and center video
					pReactorVideo.width = item.width;
					pReactorVideo.height = item.height;
					pReactorVideo.x = (_reactor1.width - pReactorVideo.width) / 2;
					pReactorVideo.y = (_reactor1.height - pReactorVideo.height) / 2;
				}
			}
		]]>
	</fx:Script>
	<s:VGroup width="100%" height="100%">
		<s:TabBar id="_tabBar" dataProvider="{_viewStack}" width="100%" height="50" />
		<mx:ViewStack id="_viewStack" creationPolicy="all" width="100%" height="100%">
			<s:NavigatorContent label="Reactor 1"  width="100%" height="100%">
				<s:BorderContainer width="100%" height="100%">
					<mx:UIComponent id="_reactor1" width="100%" height="100%" />
				</s:BorderContainer>
			</s:NavigatorContent>
			<s:NavigatorContent label="Reactor 2"  width="100%" height="100%">
				<s:BorderContainer width="100%" height="100%">
					<mx:UIComponent id="_reactor2" width="100%" height="100%" />
				</s:BorderContainer>
			</s:NavigatorContent>
			<s:NavigatorContent label="Reactor 3"  width="100%" height="100%">
				<s:BorderContainer width="100%" height="100%">
					<mx:UIComponent id="_reactor3" width="100%" height="100%" />
				</s:BorderContainer>
			</s:NavigatorContent>
		</mx:ViewStack>
	</s:VGroup>
</s:Application>
